(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,t,n){"use strict";n.r(t),n.d(t,"GET_STUDENTS",(function(){return _}));var a=n(7),r=n(15),c=n(1),o=n.n(c),s=n(111),l=n.n(s),i=n(13),u=n(12),m=n(67),d=n(68),v=n(90),f=n(32);function b(){var e=Object(r.a)(["\n    {\n        students: studentMany {\n            vkId,\n            className\n            role\n            banned\n            fullName\n            _id\n        }\n    }\n"]);return b=function(){return e},e}var _=Object(i.b)(b());t.default=function(){var e=Object(u.c)(_),t=e.data,n=e.loading,r=e.error,s=Object(d.a)([]),i=s.items,b=s.setSort,p=s.setFilter,h=s.setItems,g=Object(c.useState)(""),E=Object(a.a)(g,2),O=E[0],N=E[1],j=[{name:"\u041a\u043b\u0430\u0441\u0441\u0443",sort:function(e,t){return e.className>(null===t||void 0===t?void 0:t.className)?1:-1}},{name:"\u0420\u043e\u043b\u0438",sort:function(e,t){return e.role>t.role?1:-1}},{name:"vkId",sort:function(e,t){return e.vkId-t.vkId}},{name:"\u0418\u043c\u0435\u043d\u0438",sort:function(e,t){return e.fullName>t.fullName?1:-1}},{name:"\u0417\u0430\u0431\u0430\u043d\u0435\u043d\u043d\u043e\u0441\u0442\u0438",sort:function(e,t){return e.banned?1:-1}}];Object(c.useEffect)((function(){(null===t||void 0===t?void 0:t.students)&&h(t.students)}),[null===t||void 0===t?void 0:t.students]);return o.a.createElement("div",null,o.a.createElement(v.a,{className:l.a.filter,setSearchText:function(e){e=e.toLowerCase();N(e),p((function(t){return-1!==t.fullName.search(e)||-1!==function(e){return e.className}(t).toLowerCase().search(e)||-1!==t.role.toLowerCase().search(e)}))},sortsList:j,setSort:function(e){var t,n=null===(t=j.find((function(t){return t.name===e})))||void 0===t?void 0:t.sort;b(n||function(){return 1})}}),o.a.createElement(f.a,{query:{data:t,error:r,loading:n}},(function(){return o.a.createElement("div",{className:l.a.students},i.map((function(e){return o.a.createElement(m.b,Object.assign({key:e.vkId},e,{searchText:O}))})))})))}},111:function(e,t,n){e.exports={students:"Students_students__1UI4w",filters:"Students_filters__1FU3B"}},114:function(e,t,n){e.exports={classes:"Classes_classes__1JV5x",filters:"Classes_filters__REtBW"}},133:function(e,t,n){e.exports=n(208)},138:function(e,t,n){},20:function(e,t,n){"use strict";var a,r=n(10),c=n(22),o=n(17),s=n(1),l=n.n(s),i=n(95),u=n(59),m=n(39),d=n(128),v=n(8),f=(a={},Object(o.a)(a,v.a.delete,d.a),Object(o.a)(a,v.a.change,u.b),Object(o.a)(a,v.a.confirm,m.b),Object(o.a)(a,v.a.reject,m.c),Object(o.a)(a,v.a.add,m.a),a),b=function(e){for(var t=Object.values(v.a),n=Object.keys(e),a=!0,r=0,c=t;r<c.length;r++){var o=c[r];n.includes(o)&&(a=!1)}return a};t.a=l.a.memo((function(e){var t=e.include,n=e.props,a=void 0===n?{}:n,u=e.withRoleControl,m=void 0!==u&&u,d=e.allowOnlyAdmin,_=void 0!==d&&d,p=Object(c.a)(e,["include","props","withRoleControl","allowOnlyAdmin"]);b(a)&&"string"===typeof t&&(a=Object(o.a)({},t,a)),"string"===typeof t&&(t=[t]);var h=Object(s.useContext)(i.a).role,g=void 0===h?v.b.student:h;return m&&g!==v.b.admin&&(_||g!==v.b.contributor)?null:l.a.createElement(l.a.Fragment,null,t.map((function(e,t){if(b(a))throw new Error("If you pass props for one icon you must pass string of icon, not an array");var n=a[e],o=n.allowOnlyAdmin,s=n.allowOnlyRedactor,i=n.renderIf,u=Object(c.a)(n,["allowOnlyAdmin","allowOnlyRedactor","renderIf"]);return s&&![v.b.admin,v.b.contributor].includes(g)||o&&g!==v.b.admin||i&&!i()?null:l.a.createElement("button",{key:t}," ",l.a.createElement(f[e],Object(r.a)(Object(r.a)({},p),u))," ")})))}))},208:function(e,t,n){"use strict";n.r(t);var a=n(15),r=n(40),c=n(1),o=n.n(c),s=n(27),l=n.n(s),i=(n(138),n(95));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(13),m=n(36),d=n(35),v=n(132),f=n(56);function b(){var e=Object(a.a)(["\n    fragment StudentPreview on Student {\n        vkId\n        className\n        role,\n        banned,\n        fullName\n    }\n    fragment ClassPreview on Class {\n        name\n        studentsCount\n    }\n    extend type Mutation {\n        deleteClass(name: String): [Class]!\n        createClass(name: String): Class!\n    }\n    extend type Query {\n        sidebarOpened: Boolean\n    }\n"]);return b=function(){return e},e}var _={Mutation:{deleteClass:function(e,t,n){var a,r=t.name,c=n.cache,o=c.readQuery({query:f.GET_CLASSES}),s=(null===o||void 0===o||null===(a=o.classes)||void 0===a?void 0:a.filter((function(e){return e.name!==r})))||[];return c.writeQuery({query:f.GET_CLASSES,data:{classes:s}}),s},createClass:function(e,t,n){var a=t.name,c=n.cache,o=c.readQuery({query:f.GET_CLASSES});if(null!==o){var s=[].concat(Object(r.a)(o.classes),[{name:a,studentsCount:0,__typename:"Class",_id:Date.now().toString()}]);return c.writeQuery({query:f.GET_CLASSES,data:{classes:s}}),{name:a,studentsCount:0,__typename:"Class",_id:Date.now().toString()}}return null}}},p=Object(u.b)(b()),h=new u.a({uri:"/graphql",cache:new v.a({dataIdFromObject:function(e){return e._id?e._id:null}}),resolvers:_,typeDefs:p});l.a.render(o.a.createElement(m.a,{client:h},o.a.createElement(d.a,null,o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.b,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},24:function(e,t,n){e.exports={info:"StudentInfo_info__1Ymgm",nested:"StudentInfo_nested__1TL1s",changer:"StudentInfo_changer__h8fXg"}},30:function(e,t,n){e.exports={preview:"ClassPreview_preview__2shJn",link:"ClassPreview_link__4ll1M",name:"ClassPreview_name__2Y8xa",remove:"ClassPreview_remove__1efHk",wrapper:"ClassPreview_wrapper__zis8n",creator:"ClassPreview_creator__1ZeiZ",creator_stab:"ClassPreview_creator_stab__1ZON7",with_error:"ClassPreview_with_error__1ziVu",reject:"ClassPreview_reject__1hamE",confirm:"ClassPreview_confirm__jvhjy"}},31:function(e,t,n){e.exports={sidebar:"Sidebar_sidebar__2WupE",opened:"Sidebar_opened__1EtRw",closed:"Sidebar_closed__1flj4",check:"Sidebar_check__3fHhr",link:"Sidebar_link__t3vmZ",active:"Sidebar_active__37KeR",userInfo:"Sidebar_userInfo__3SDcZ",hamb:"Sidebar_hamb__1VJx6"}},32:function(e,t,n){"use strict";var a=n(40),r=n(1),c=n.n(r);t.a=function(e){var t=e.query,n=e.children,r=e.queries;if(r){if(r.some((function(e){return e.error})))return c.a.createElement("div",null," ",r.map((function(e,t){return c.a.createElement("span",{key:"SuspenderErrorSpan"+t}," ",e.error&&JSON.stringify(e.error,null,2)," ",c.a.createElement("br",null))}))," ");if(r.some((function(e){return e.loading})))return c.a.createElement("div",null," loading... ");if(r.every((function(e){return e.data})))return n.apply(void 0,Object(a.a)(r.map((function(e){return e.data}))))}else{if(!t)return c.a.createElement("div",null," \u041e\u0448\u0438\u0431\u043e\u0447\u043a\u0430 ");var o=t.error,s=t.loading,l=t.data;if(o)return c.a.createElement("div",null," ",JSON.stringify(o,null,2)," ");if(s)return c.a.createElement("div",null," loading... ");if(l&&n)return n(l)}return null}},34:function(e,t,n){e.exports={days:"ScheduleSection_days__3q5Ka",day:"ScheduleSection_day__1vyXS",lessons:"ScheduleSection_lessons__2YKwz",dayName:"ScheduleSection_dayName__2YlSO",lesson:"ScheduleSection_lesson__2VgGS",addLesson:"ScheduleSection_addLesson__1o9eX",lessonChange:"ScheduleSection_lessonChange__3byuj",selectLesson:"ScheduleSection_selectLesson__3QoXk",removeLesson:"ScheduleSection_removeLesson__1WgRJ",pen:"ScheduleSection_pen__1rpG9",changers:"ScheduleSection_changers__kapIC",changer:"ScheduleSection_changer__geJuc"}},41:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return d}));var a=n(7),r=n(40),c=n(54),o=n(1),s=n.n(o),l=n(62),i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"highlight";if(""!==t.trim()){var a=e.toLowerCase();t=t.toLowerCase();var r=a.search(t);if(-1!==r)return s.a.createElement("span",null," ",e.slice(0,r)," ",s.a.createElement("span",{className:n}," ",e.slice(r,r+t.length)," ")," ",e.slice(r+t.length,e.length-r+t.length)," ")}return s.a.createElement("span",null," ",e," ")},u=function(e){var t={},n={};e.sort((function(e,t){return Date.parse(e.to)-Date.parse(t.to)}));var a,o=Object(c.a)(e);try{for(o.s();!(a=o.n()).done;){var s=a.value,i=Object(l.b)(s.to,"dd MM");Date.parse(s.to)>Date.now()?t[i]=[].concat(Object(r.a)(t[i]||[]),[s]):n[i]=[].concat(Object(r.a)(n[i]||[]),[s])}}catch(u){o.e(u)}finally{o.f()}return[n,t]},m=function(e,t){var n=Object.entries(e).map((function(e){var n=Object(a.a)(e,2),r=n[0],c=n[1];return[r,t(c)]}));return Object.fromEntries(n)},d=function(e){if(new RegExp("\\d\\s(".concat(Object.values(l.a).join("|"),")"),"i").test(e)){var t=e.split(" "),n=Object(a.a)(t,2),r=n[0],c=n[1];if(-1!==l.a.indexOf(c)&&!isNaN(Number(r))){var o=l.a.indexOf(c);return new Date((new Date).getFullYear(),o,Number(r)).toISOString()}}return""}},43:function(e,t,n){e.exports={student:"StudentPage_student__35x4H",header:"StudentPage_header__2dllD",info:"StudentPage_info__1vBbh",vkId:"StudentPage_vkId__21U-K",name:"StudentPage_name__SPqIK",icons:"StudentPage_icons__3Fgbh",icon:"StudentPage_icon__1efPx",pen:"StudentPage_pen__2ZNGy",trash:"StudentPage_trash__4aQTV",ban:"StudentPage_ban__2-mDG",close:"StudentPage_close__2OyIZ",unban:"StudentPage_unban__cqPJT",check:"StudentPage_check__hRCaY",body:"StudentPage_body__2Fb8u"}},50:function(e,t,n){e.exports={contentChanger:"ChangeContent_contentChanger__12-4F",header:"ChangeContent_header__3aPBy",text:"ChangeContent_text__1ahJ0",title:"ChangeContent_title__1Hr35",uploaderIcon:"ChangeContent_uploaderIcon__OJQN4",datePickerInput:"ChangeContent_datePickerInput__3r1lT",datePickerCalendar:"ChangeContent_datePickerCalendar__3SGbg",attachmentsContainer:"ChangeContent_attachmentsContainer__3IZm3"}},53:function(e,t,n){e.exports={preview:"StudentPreview_preview__1lor8",link:"StudentPreview_link__1sI1z",info:"StudentPreview_info__1csGq",ban:"StudentPreview_ban__1DKmG",unban:"StudentPreview_unban__16vF7",button:"StudentPreview_button__1xz_x",banned:"StudentPreview_banned__1NUVJ"}},55:function(e,t,n){e.exports={next:"OpenableImage_next__3-Tqb",prev:"OpenableImage_prev__1sXgd",deletableAttachment:"OpenableImage_deletableAttachment__jaRwb",removeAttachment:"OpenableImage_removeAttachment__1RJcn"}},56:function(e,t,n){"use strict";n.r(t),n.d(t,"GET_CLASSES",(function(){return I}));var a=n(7),r=n(15),c=n(1),o=n.n(c),s=n(13),l=n(12),i=n(30),u=n.n(i),m=n(41),d=n(35),v=n(8),f=n(20),b=n(69);function _(){var e=Object(r.a)(["\n    mutation RemoveOne($className: String!){\n        classRemoveOne(className: $className) {\n            name\n            __typename\n        }\n        deleteClass(name: $className) @client\n    }\n"]);return _=function(){return e},e}var p=Object(s.b)(_()),h=Object(c.memo)((function(e){var t=e.className,n=e.studentsCount,r=e.searchText,s=Object(l.b)(p,{variables:{className:t}}),i=Object(a.a)(s,2),_=i[0],h=i[1],g=h.error,E=h.data,O=Object(c.useState)(!1),N=Object(a.a)(O,2),j=N[0],C=N[1],S=function(e){return Object(m.b)(e,r)};return g&&console.error(g),E?o.a.createElement("div",{className:u.a.preview,style:{backgroundColor:"var(--secondary)"}},o.a.createElement("div",{className:u.a.firstRow}),o.a.createElement("div",{className:u.a.secondRow})):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:u.a.preview},o.a.createElement(d.b,{to:"/classes/".concat(t),className:u.a.link},o.a.createElement("p",{className:u.a.name}," ",S(t)," "),o.a.createElement("div",{className:u.a.count}," \u0423\u0447\u0435\u043d\u0438\u043a\u043e\u0432: ",S(String(n))," "),o.a.createElement("div",null)),o.a.createElement(f.a,{include:v.a.delete,props:{onClick:function(){return C(!0)},size:20,className:"remove"}})),j&&o.a.createElement(b.a,{text:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ".concat(t," \u043a\u043b\u0430\u0441\u0441"),onConfirm:function(){return _()},returnRes:function(){return C(!1)}}))})),g=n(114),E=n.n(g);function O(){var e=Object(r.a)(["\n    mutation CreateClass($name: String!) {\n#        createClass(name: $name) @client\n        classCreateOne(className: $name) {\n            name\n            __typename\n            studentsCount\n        }\n    }\n"]);return O=function(){return e},e}var N=Object(s.b)(O()),j=function(e){if(/([0-9]{1,2})\s*([A-Z]|[\u0410-\u042f]){1}/i.test(e)){var t=e.match(/([0-9]{1,2})\s*([A-Z]|[\u0410-\u042f]){1}/i);if(null!==t){var n=Object(a.a)(t,3),r=(n[0],n[1]),c=n[2];if(+r>0&&+r<=12)return[+r,c]}}return null},C=function(){var e=Object(c.useState)(!1),t=Object(a.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),i=Object(a.a)(s,2),m=i[0],d=i[1],b=Object(c.useState)(null),_=Object(a.a)(b,2),p=_[0],h=_[1],g=Object(l.b)(N,{variables:{name:m.toUpperCase().replace(/\s/g,"")},optimisticResponse:{classCreateOne:{name:m,studentsCount:0,__typename:"Class"}},update:function(e,t){var n,a;t.data&&e.writeQuery({query:I,data:{classes:null===(n=e.readQuery({query:I}))||void 0===n?void 0:n.classes.concat([null===(a=t.data)||void 0===a?void 0:a.classCreateOne])}})}}),E=Object(a.a)(g,1)[0],O=function(e){e.preventDefault(),j(m)?(E(),r(!1),d(""),h(null)):(d(""),h("\u041d\u0435\u0432\u0435\u0440\u043d\u043e\u0435 \u0438\u043c\u044f \u043a\u043b\u0430\u0441\u0441\u0430"))};return o.a.createElement("div",{className:u.a.wrapper},o.a.createElement("div",{className:"".concat(u.a.creator," ").concat(n?"":u.a.creator_stab," ").concat(u.a.preview),onClick:function(){return r(!0)}},n?o.a.createElement("form",{onSubmit:O,className:u.a.form},o.a.createElement(f.a,{include:v.a.reject,size:20,onClick:function(e){e.stopPropagation(),r(!1),d(""),h(null)},className:"reject ".concat(u.a.button)}),o.a.createElement("input",{onChange:function(e){return d(e.target.value)},value:m,autoFocus:!0,type:"text",placeholder:null!==p&&void 0!==p?p:"\u0418\u043c\u044f \u043a\u043b\u0430\u0441\u0441\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0446\u0438\u0444\u0440\u0430 \u0431\u0443\u043a\u0432\u0430",className:"".concat(p?u.a.with_error:""," ").concat(u.a.input)}),o.a.createElement(f.a,{include:v.a.confirm,size:20,onClick:O,className:"confirm ".concat(u.a.button)})):"Create class"))},S=n(90),y=n(68),k=n(32);function w(){var e=Object(r.a)(["\n  query GetClasses {\n    classes: classMany {\n      studentsCount\n      name\n      __typename\n    }\n  }\n"]);return w=function(){return e},e}var I=Object(s.b)(w());t.default=function(){var e,t=Object(l.c)(I),n=Object(y.a)([]),r=n.items,s=n.setFilter,i=n.setSort,u=n.setItems,m=Object(c.useState)(""),d=Object(a.a)(m,2),v=d[0],f=d[1],b=[{name:"\u041a\u043e\u043b-\u0432\u0443 \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432",sort:function(e,t){return e.studentsCount>t.studentsCount?-1:1}},{name:"\u0418\u043c\u0435\u043d\u0438",sort:function(e,t){return e.name>t.name?1:-1}}],_=function(e){e=e.toLowerCase(),f(e),s((function(t){return-1!==t.name.toLowerCase().search(e)||-1!==t.studentsCount.toString().toLowerCase().search(e)}))},p=function(e){var t,n=null===(t=b.find((function(t){return t.name===e})))||void 0===t?void 0:t.sort;i(n||function(){return 1})};return Object(c.useEffect)((function(){var e;(null===(e=t.data)||void 0===e?void 0:e.classes)&&u(t.data.classes)}),[null===(e=t.data)||void 0===e?void 0:e.classes]),o.a.createElement(k.a,{query:t},(function(){return o.a.createElement("div",null,o.a.createElement(S.a,{className:E.a.filters,setSearchText:_,sortsList:b,setSort:p}),o.a.createElement(C,null),o.a.createElement("div",{className:E.a.classes},r.map((function(e){return o.a.createElement(h,{searchText:v,key:e.name,className:e.name,studentsCount:e.studentsCount})}))))}))}},57:function(e,t,n){e.exports={container:"Confirm_container__33FAp",text:"Confirm_text__3dBJ7",options:"Confirm_options__3Qx7U",btn:"Confirm_btn__MeP3E",confirm:"Confirm_confirm__1kCU6",reject:"Confirm_reject__2ALzd"}},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n(54),r=["Y","M","d","h","m","s","ms"],c=["\u042f\u043d\u0432\u0430\u0440\u044f","\u0424\u0435\u0432\u0440\u0430\u043b\u044f","\u041c\u0430\u0440\u0442\u0430","\u0410\u043f\u0440\u0435\u043b\u044f","\u041c\u0430\u044f","\u0418\u044e\u043d\u044f","\u0418\u044e\u043b\u044f","\u0410\u0432\u0433\u0443\u0441\u0442\u0430","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u041e\u043a\u0442\u044f\u0431\u0440\u044f","\u041d\u043e\u044f\u0431\u0440\u044f","\u0414\u0435\u043a\u0430\u0431\u0440\u044f"],o=function(e,t){if("object"!==typeof e?!isNaN(Date.parse(e)):e){var n,o=new Date(e),s=Object(a.a)(r);try{for(s.s();!(n=s.n()).done;){var l=n.value,i=t.match(RegExp("".concat(l,"+")));if(i){var u=i[0];switch(l){case"Y":if(4!=u.length&&2!=u.length)throw new Error("Year must be 2 or 4 length");t=4==u.length?t.replace(/Y+/i,String(o.getFullYear())):t.replace(/Y+/i,String(o.getFullYear()%100));break;case"M":if(2!=u.length)throw new Error("Month must be 2 length");t=t.match(RegExp("".concat(l,"+n")))?t.replace(/M+n/i,String(o.getMonth()+1)):t.replace(/M+/i,String(c[o.getMonth()]));break;case"d":if(2!=u.length)throw new Error("Day must be 2 length");t=t.replace(/d+/i,String(o.getDate()));break;case"h":if(2!=u.length)throw new Error("Hours must be 2 length");t=t.replace(/h+/i,String(o.getHours()));break;case"m":if(2!=u.length)throw new Error("Minutes must be 2 length");t=t.replace(/m+/i,String(o.getMinutes()));break;case"s":if(2!=u.length)throw new Error("Seconds must be 2 length");t=t.replace(/s+/i,String(o.getSeconds()));break;case"ms":if(4!=u.length)throw new Error("Minutes must be 4 length");t=t.replace(/ms+/i,String(o.getMilliseconds()))}}}}catch(m){s.e(m)}finally{s.f()}return t}throw new Error("Date str must be date iso string")}},64:function(e,t,n){e.exports={students:"StudentSection_students__1rLZ7",student:"StudentSection_student__2hIL3",remove:"StudentSection_remove__3ChUr",creator:"StudentSection_creator__2Y1zR",chooseStudent:"StudentSection_chooseStudent__7KBu6",title:"StudentSection_title__1M9dd",studentsChooser:"StudentSection_studentsChooser__3YDcw",chooser:"StudentSection_chooser__2cEEQ",chooser_name:"StudentSection_chooser_name__1Gcvk",chooser_vkId:"StudentSection_chooser_vkId__-ImTl",chooser_className:"StudentSection_chooser_className__3RSo-"}},67:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(7),r=n(15),c=n(1),o=n.n(c),s=n(53),l=n.n(s),i=n(59),u=n(13),m=n(12),d=n(41),v=n(35);function f(){var e=Object(r.a)(["\n    mutation BanStudent($vkId: Int!, $isBan: Boolean){\n        banStudent(vkId: $vkId, isBan: $isBan) {\n            banned\n            _id\n            __typename\n        }\n    }\n"]);return f=function(){return e},e}var b=Object(u.b)(f());function _(e){var t,n;return e?e.split(" ")[0]+" "+((null===(t=e.split(" ")[1])||void 0===t||null===(n=t[0])||void 0===n?void 0:n.toUpperCase())||""):"Error empty name"}t.b=Object(c.memo)((function(e){var t=e.vkId,n=e.role,r=e.banned,c=e.className,s=e.searchText,u=e.fullName,f=e._id,p=Object(m.b)(b,{variables:{vkId:t,isBan:!r},optimisticResponse:{__typename:"Mutation",banStudent:{banned:!r,_id:f,__typename:"Student"}}}),h=Object(a.a)(p,1)[0],g=function(e){return Object(d.b)(e,s||"")};return o.a.createElement("div",{className:"".concat(l.a.preview," ").concat(r&&l.a.banned)},o.a.createElement(v.b,{to:"/students/".concat(t),className:"".concat(l.a.link)},o.a.createElement("span",{className:l.a.info}," ",g(_(u))," "),o.a.createElement("span",{className:l.a.info}," ",g(_(n))," "),o.a.createElement("span",{className:l.a.info}," ",g(_(c))," ")),r?o.a.createElement(i.c,{size:20,onClick:function(){h()},className:"unban ".concat(l.a.button)}):o.a.createElement(i.d,{size:20,onClick:function(){h()},className:"ban ".concat(l.a.button)}))}))},68:function(e,t,n){"use strict";var a=n(40),r=n(7),c=n(1);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return 0},o=Object(c.useState)([]),s=Object(r.a)(o,2),l=s[0],i=s[1],u=Object(c.useState)(e.filter(t).sort(n)),m=Object(r.a)(u,2),d=m[0],v=m[1],f=function(e){v(l.filter(e))},b=function(e){v(Object(a.a)(l.sort(e)))};return{items:d,setFilter:f,setSort:b,setItems:function(e){i(e),v(e)}}}},69:function(e,t,n){"use strict";var a=n(1),r=n.n(a),c=n(27),o=n.n(c),s=n(57),l=n.n(s),i=document.querySelector("#confirmModal");t.a=function(e){var t=e.text,n=void 0===t?"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u044d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435":t,a=e.returnRes,c=e.confirmElement,s=e.onConfirm,u=e.onReject,m=e.rejectElement,d=function(e){e?null===s||void 0===s||s():null===u||void 0===u||u(),null===a||void 0===a||a(e)};return i&&o.a.createPortal(r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:l.a.container},r.a.createElement("span",{className:l.a.text},n),r.a.createElement("div",{className:l.a.options},c?m:r.a.createElement("button",{onClick:function(){return d(!1)},className:"".concat(l.a.btn," ").concat(l.a.reject)},"\u041d\u0435\u0442"),m?c:r.a.createElement("button",{onClick:function(){return d(!0)},className:"".concat(l.a.btn," ").concat(l.a.confirm)},"\u0414\u0430")))),i)}},73:function(e,t,n){e.exports={section:"InfoSection_section__2atD5",header:"InfoSection_header__12h4j",name:"InfoSection_name__KAhQy",triangle_opened:"InfoSection_triangle_opened__3IWZR",content:"InfoSection_content__3JIV4",search:"InfoSection_search__noItu"}},79:function(e,t,n){e.exports={filterContainer:"Filters_filterContainer__3Rp10",filters:"Filters_filters__1g5Lf",search:"Filters_search__2ZSJ3",sorts:"Filters_sorts__193FZ"}},8:function(e,t,n){"use strict";var a,r;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e.student="STUDENT",e.admin="ADMIN",e.contributor="CONTRIBUTOR"}(a||(a={})),function(e){e.delete="DELETE",e.change="CHANGE",e.confirm="CONFIRM",e.reject="REJECT",e.add="ADD"}(r||(r={}))},80:function(e,t,n){e.exports={class:"ClassPage_class__3QktT",header:"ClassPage_header__2hPm6",className:"ClassPage_className__2uScq"}},81:function(e,t,n){e.exports={contentChanger:"ContentChanger_contentChanger__2VEle",header:"ContentChanger_header__2HZcT"}},9:function(e,t,n){e.exports={content:"ContentSection_content__30jxd",contentCreator:"ContentSection_contentCreator__3KZrm",confirmReject:"ContentSection_confirmReject__2FMaC",title:"ContentSection_title__1heCx",lessonPicker:"ContentSection_lessonPicker__mnElv",addition:"ContentSection_addition__5UtaH",offseted:"ContentSection_offseted__3oi0u",text:"ContentSection_text__WbjBQ",sectionHeader:"ContentSection_sectionHeader__28gmm",addContent:"ContentSection_addContent__1DJPX",contentHeader:"ContentSection_contentHeader__96G_n",oldContentHeader:"ContentSection_oldContentHeader__8fTWM",removeOldContent:"ContentSection_removeOldContent__GCCCO",date:"ContentSection_date__2lAsa",lesson:"ContentSection_lesson__3YkAK",accordion:"ContentSection_accordion__3jwwC",triangle_opened:"ContentSection_triangle_opened__3Y-Oq",elements:"ContentSection_elements__2UZ1N",container:"ContentSection_container__5RMFh",pair:"ContentSection_pair__2mgVI",element:"ContentSection_element__1HrRa",attachments:"ContentSection_attachments__hhBYd",stab:"ContentSection_stab__260Ri",fullText:"ContentSection_fullText__2W_7h",controls:"ContentSection_controls__1Mfs5",remove:"ContentSection_remove__o9pM6",contentContentChanger:"ContentSection_contentContentChanger__1PINq"}},90:function(e,t,n){"use strict";var a=n(7),r=n(22),c=n(1),o=n.n(c),s=n(79),l=n.n(s);t.a=function(e){var t=e.sortsList,n=e.setSearchText,s=e.setSort,i=Object(r.a)(e,["sortsList","setSearchText","setSort"]),u=Object(c.useState)(""),m=Object(a.a)(u,2),d=m[0],v=m[1];return o.a.createElement("div",Object.assign({},i,{className:i.className||l.a.filterContainer}),o.a.createElement("div",{className:l.a.filters},n&&o.a.createElement("div",{className:l.a.search},o.a.createElement("input",{style:{color:"var(--main)"},placeholder:"\u041f\u043e\u0438\u0441\u043a",type:"text",onChange:function(e){v(e.target.value),n(e.target.value)},value:d})),(null===t||void 0===t?void 0:t.length)&&s&&o.a.createElement("div",{className:l.a.sorts},o.a.createElement("select",{onChange:function(e){return s(e.target.value)},name:"sorts",id:"sorts"},o.a.createElement("option",{key:"none",value:"none"}," \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e"),t.map((function(e){var t=e.name;return o.a.createElement("option",{key:t,value:t},t)}))))))}},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return Gt}));var a=n(72),r=n.n(a),c=n(10),o=n(84),s=n(7),l=n(15),i=n(1),u=n.n(i),m=n(31),d=n.n(m),v=n(35),f=n(123),b=n(59),_=n(8),p=function(e){var t=e.userInfo,n=t.first_name,a=t.last_name,r=t.photo_rec,c=e.resetUser;return u.a.createElement("div",{className:d.a.userInfo},u.a.createElement("img",{src:"https://vk.com"+r,alt:"\u0424\u043e\u0442\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),u.a.createElement("span",{className:d.a.userName},n," ",a),u.a.createElement("button",{className:d.a.logOut,onClick:function(){c(),localStorage.removeItem("user")}}," \u0412\u044b\u0439\u0442\u0438 "))},h=function(e){var t=e.setUser,n=Object(i.useContext)(Gt),a=n.first_name,r=n.last_name,c=n.photo_rec,o=n.role,s=n.className,l=n.uid;return u.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:d.a.sidebar},u.a.createElement("input",{type:"checkbox",id:d.a.check}),u.a.createElement("label",{htmlFor:d.a.check},u.a.createElement(b.a,{className:d.a.opened,size:20}),u.a.createElement(f.a,{className:d.a.closed,size:20})),o===_.b.admin?u.a.createElement(u.a.Fragment,null,u.a.createElement(v.c,{to:"/classes",className:d.a.link,activeClassName:d.a.active}," \u041a\u043b\u0430\u0441\u0441\u044b "),u.a.createElement(v.c,{to:"/students",className:d.a.link,activeClassName:d.a.active}," \u0423\u0447\u0435\u043d\u0438\u043a\u0438 ")):u.a.createElement(u.a.Fragment,null,u.a.createElement(v.c,{to:"/classes/".concat(s),className:d.a.link,activeClassName:d.a.active}," \u041a\u043b\u0430\u0441\u0441 "),u.a.createElement(v.c,{to:"/students/".concat(l),className:d.a.link,activeClassName:d.a.active}," \u0423\u0447\u0435\u043d\u0438\u043a ")),a&&r&&c&&u.a.createElement(v.c,{to:"/students/".concat(l),className:d.a.userInfo},u.a.createElement(p,{userInfo:{first_name:a,last_name:r,photo_rec:c},resetUser:function(){return t(null)}})))},g=n(29),E=n(17),O=n(22),N=n(54),j=n(87),C=n(43),S=n.n(C),y=n(13),k=n(12),w=n(24),I=n.n(w);function x(){var e=Object(l.a)(["\n    {\n        classes: classMany {\n            name\n        }\n        roles: getRoles\n    }\n"]);return x=function(){return e},e}var H=function(e){var t=e.changeHandler,n=e.defaultValue,a=e.options,r=void 0===a?["     "]:a;return u.a.createElement("select",{onChange:function(e){return t(e.target.value)}},u.a.createElement("option",{key:n,value:n},n),r.map((function(e){return e!==n&&u.a.createElement("option",{key:e,value:e},e)})))},P=Object(y.b)(x()),$=function(e){var t=e.name,n=e.value,a=e.changeHandler,r=Object(k.c)(P),c=r.data,o=(r.loading,r.error);return o?u.a.createElement("div",null,o):u.a.createElement("div",{className:"".concat(I.a.changing)},"string"==typeof n&&u.a.createElement(u.a.Fragment,null,"className"===t||"role"===t||"notificationTime"===t?u.a.createElement(u.a.Fragment,null,"className"===t&&u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement(H,{changeHandler:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return a(t,e)})),defaultValue:n,options:null===c||void 0===c?void 0:c.classes.map((function(e){return e.name})).concat(["\u041d\u0435\u0442\u0443"])})),"role"===t&&u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement(H,{changeHandler:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return a(t,e)})),defaultValue:n,options:null===c||void 0===c?void 0:c.roles})),"notificationTime"===t&&u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement("input",{type:"text",className:"".concat(I.a.changeString),defaultValue:n,onChange:function(e){return a(t,e.target.value)}}))):u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement("input",{type:"text",className:"".concat(I.a.changeString),defaultValue:n,onChange:function(e){return a(t,e.target.value)}}))),"number"===typeof n&&u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement("input",{type:"number",className:"".concat(I.a.changeNumber),defaultValue:n,onChange:function(e){return a(t,+e.target.value)}})),"boolean"===typeof n&&u.a.createElement("div",{className:I.a.changer},R[t]||t,": ",u.a.createElement("input",{type:"checkbox",className:"".concat(I.a.changeBool),defaultChecked:n,onChange:function(e){return a(t,e.target.checked)}})),"object"===typeof n&&u.a.createElement("div",{className:"".concat(I.a.changer)},R[t]||t,":",u.a.createElement("div",{className:I.a.nested},Object.entries(n).map((function(e){return u.a.createElement(M,{isChanging:!0,name:e[0],value:e[1],key:t+e[0],changeHandler:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,n){return a("".concat(t,".").concat(e),n)}))})})))))},R={vkId:"\u0412\u041a id",role:"\u0420\u043e\u043b\u044c",settings:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",notificationsEnabled:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b",notificationTime:"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u044f",lastHomeworkCheck:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u0437",className:"\u041a\u043b\u0430\u0441\u0441"},M=function e(t){var n=t.name,a=t.value,r=t.changeHandler,c=t.isChanging;if(!["__typename",null,"_id"].includes(n)){var o=function(e){return"boolean"===typeof e?e?"\u0414\u0430":"\u041d\u0435\u0442":e}(a);return u.a.createElement("div",{className:I.a.info},c&&"vkId"!==n?u.a.createElement($,{changeHandler:r,name:n,value:a}):u.a.createElement("div",{className:"".concat(I.a.showing)},"string"==typeof a||"number"==typeof a||"boolean"===typeof a?u.a.createElement("div",{className:I.a.value},R[n]||n,": ",o):u.a.createElement("div",{className:I.a.value},R[n]||n,":",u.a.createElement("div",{className:I.a.nested},Object.entries(a).map((function(t){return u.a.createElement(e,{isChanging:c,name:t[0],value:t[1],key:n+t[0],changeHandler:function(e,t){return r("".concat(n,".").concat(e),t)}})}))))))}return n&&null===a?u.a.createElement("div",{className:I.a.info},c?u.a.createElement($,{changeHandler:r,name:n,value:a}):u.a.createElement("div",{className:"".concat(I.a.showing)},u.a.createElement("div",{className:I.a.value}," ",R[n]||n,": ","\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"))):u.a.createElement(u.a.Fragment,null)},D=n(62),F=n(67),q=n(110),T=n(32),z=n(20),L=n(69);function A(){var e=Object(l.a)(["\n    mutation DeleteStudent($vkId: Int!) {\n        removed: studentRemoveOne(vkId: $vkId) {\n            vkId\n        }\n    }\n"]);return A=function(){return e},e}function B(){var e=Object(l.a)(["\n    mutation ChangeClass($vkId: Int!, $className: String!) {\n        changeClass(vkId: $vkId, newClassName: $className) {\n            __typename\n            vkId\n            _id\n            className\n        }\n    }\n"]);return B=function(){return e},e}function Q(){var e=Object(l.a)(["\n    mutation UpdateStudent($record: UpdateOneStudentInput!, $vkId: Float!) {\n        updatedStudent: studentUpdateOne(filter: {vkId: $vkId}, record: $record) {\n            record {\n                vkId\n                className\n                role\n                banned\n                settings {\n                    notificationsEnabled\n                    notificationTime\n                }\n                lastHomeworkCheck\n                fullName\n                _id\n                __typename\n            }\n        }\n    }\n"]);return Q=function(){return e},e}function G(){var e=Object(l.a)(["\n    {\n        classMany {\n            name\n        }\n    }\n"]);return G=function(){return e},e}function U(){var e=Object(l.a)(["\n    query GetStudent($vkId: Float){\n        studentOne(filter: {vkId: $vkId}) {\n            vkId\n            className\n            role\n            banned\n            settings {\n                notificationsEnabled\n                notificationTime\n            }\n            lastHomeworkCheck\n            fullName\n            _id\n        }\n    }\n"]);return U=function(){return e},e}var Y=Object(y.b)(U()),J=(Object(y.b)(G()),Object(y.b)(Q())),V=Object(y.b)(B()),Z=Object(y.b)(A()),W=function(e){Object(j.a)(e);var t=Number(Object(g.g)().vkId),n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],o=a[1],l=Object(i.useState)({}),m=Object(s.a)(l,2),d=m[0],v=m[1],f=Object(i.useState)(!1),b=Object(s.a)(f,2),p=b[0],h=b[1],C=Object(i.useState)(!1),y=Object(s.a)(C,2),w=y[0],I=y[1],x=Object(k.c)(Y,{variables:{vkId:t}}),H=x.data,P=x.loading,$=x.error,R=Object(k.b)(F.a),A=(Object(s.a)(R,1)[0],Object(k.b)(J)),B=Object(s.a)(A,1)[0],Q=Object(k.b)(V),G=Object(s.a)(Q,1)[0],U=Object(k.b)(Z),W=Object(s.a)(U,1)[0],K=function(e,t){if(-1!==e.search(".")){var n,a=e.split("."),r=d,o=Object(N.a)(a.slice(0,a.length-1));try{for(o.s();!(n=o.n()).done;){var s=n.value;r[s]?r=d[s]:(r[s]={},r=r[s])}}catch(l){o.e(l)}finally{o.f()}r[a[a.length-1]]=t,v(Object(c.a)({},d))}else v(Object(c.a)(Object(c.a)({},d),{},{path:t}))},X=function(){var e;if(d.className){var n=d.className;"string"===typeof n&&(G({variables:{className:n,vkId:t},optimisticResponse:{changeClass:{vkId:t,__typename:"Student",className:n},__typename:"Mutation"}}),delete d.className)}if(null===(e=d.settings)||void 0===e?void 0:e.notificationTime){var a,r=null===(a=d.settings)||void 0===a?void 0:a.notificationTime.split(":").map(Number).filter(Number.isInteger),o=Object(s.a)(r,2),l=o[0],i=o[1];l&&i&&l>=0&&l<=23&&i>=0&&i<=59||delete d.settings.notificationTime}if(d.lastHomeworkCheck&&(Date.parse(d.lastHomeworkCheck)||delete d.lastHomeworkCheck),Object.getOwnPropertyNames(d).length){var u=d.settings;delete d.settings,console.log(Object(c.a)(Object(c.a)({},d),{},{settings:u})),B({variables:{vkId:t,record:Object(c.a)(Object(c.a)({},d),{},{settings:u})},optimisticResponse:{__typename:"Mutation",updatedStudent:{record:Object(c.a)(Object(c.a)(Object(c.a)({__typename:"Student",vkId:t},null===H||void 0===H?void 0:H.studentOne),d),{},{settings:Object(c.a)(Object(c.a)({},null===H||void 0===H?void 0:H.studentOne.settings),u)}),__typename:"UpdateStudent"}}})}};return p?u.a.createElement(g.a,{to:"/students/"}):u.a.createElement(u.a.Fragment,null,u.a.createElement(T.a,{query:{data:H,loading:P,error:$}},(function(e){var t,n,a=e.studentOne,c=a.fullName,s=(a.banned,a.__typename,a._id,Object(O.a)(a,["fullName","banned","__typename","_id"]));return s.className=s.className,s.lastHomeworkCheck="1970-01-01T00:00:00.000Z"===s.lastHomeworkCheck?"\u041d\u0438\u043a\u043e\u0433\u0434\u0430":Object(D.b)(s.lastHomeworkCheck,"YYYY.MMn.dd hh:mm"),u.a.createElement("div",{className:S.a.student},u.a.createElement("div",{className:S.a.header},u.a.createElement("div",{className:S.a.info},u.a.createElement("div",{className:S.a.name}," ",c," ")),u.a.createElement("div",{className:S.a.icons},r?u.a.createElement(z.a,{include:[_.a.reject,_.a.confirm],props:(t={},Object(E.a)(t,_.a.reject,{className:S.a.icon+" negative",onClick:function(){return v({}),o(!1)}}),Object(E.a)(t,_.a.confirm,{className:S.a.icon+" positive",onClick:function(){X(),o(!1)},allowOnlyAdmin:!0}),t),size:30}):u.a.createElement(z.a,{include:[_.a.change,_.a.delete],props:(n={},Object(E.a)(n,_.a.change,{onClick:function(){return o(!0)},className:"".concat(S.a.icon," ").concat(S.a.pen),size:24}),Object(E.a)(n,_.a.delete,{onClick:function(){return I(!0)},className:"".concat(S.a.icon," remove")}),n),size:30,withRoleControl:!0,allowOnlyAdmin:!0}))),u.a.createElement("div",{className:S.a.body},Object.entries(s).map((function(e){return u.a.createElement(M,{name:e[0],value:e[1],isChanging:r,key:"".concat(e[0]),changeHandler:K})}))))})),w&&u.a.createElement(L.a,{text:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0447\u0435\u043d\u0438\u043a\u0430",onConfirm:function(){W({variables:{vkId:t},optimisticResponse:{__typename:"Mutation",removed:{vkId:t,__typename:"Student"}},update:function(e,t){var n=e.readQuery({query:q.GET_STUDENTS});e.writeQuery({query:q.GET_STUDENTS,data:{students:null===n||void 0===n?void 0:n.students.filter((function(e){var n;return e.vkId!==(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.removed.vkId)}))}}),h(!0)}})},returnRes:function(){return I(!1)}}))},K=n(80),X=n.n(K),ee=n(73),te=n.n(ee),ne=n(39),ae={position:"relative"},re={position:"absolute",color:"var(--main)",right:"0.5rem",top:"calc(50% - 15px/2)"},ce={borderRadius:"10px",height:"100%",color:"var(--main)",paddingLeft:"5px",boxSizing:"border-box"},oe=u.a.memo((function(e){var t=e.changeHandler,n=e.text;return u.a.createElement("div",{style:ae,onClick:function(e){return e.stopPropagation()}},u.a.createElement("input",{style:ce,type:"text",value:n,onChange:function(e){return t(e.target.value)}}),u.a.createElement(ne.c,{onClick:function(){return t("")},style:re,className:"negative",size:15}))})),se=u.a.memo((function(e){var t=e.Body,n=e.Head,a=(e.children,e.initiallyOpened),r=e.isOpened,c=Object(O.a)(e,["Body","Head","children","initiallyOpened","isOpened"]),o=Object(i.useState)(null===a||void 0===a||a),l=Object(s.a)(o,2),m=l[0],d=l[1];return Object(i.useEffect)((function(){void 0!==r&&d(r)}),[r]),u.a.createElement("div",c,u.a.createElement("div",{className:"accordion"},"function"===typeof n?u.a.createElement(n,{onClick:function(){return d(!m)},opened:m}):n),m&&u.a.createElement(u.a.Fragment,null,"function"===typeof t?u.a.createElement(t,{opened:m}):t))})),le=n(42),ie=u.a.memo((function(e){var t=e.name,n=e.children,a=e.className,r=void 0===a?"":a,c=e.updateSearchString,o=e.Header,l=e.defaultSearchString,m=void 0===l?"":l,d=Object(i.useState)(!0),v=Object(s.a)(d,2),f=v[0],b=v[1],_=function(){return b(!f)};return u.a.createElement("div",{className:te.a.section},u.a.createElement(se,{isOpened:f,Head:u.a.createElement(u.a.Fragment,null,o?u.a.createElement(o,{onClick:_,opened:f}):u.a.createElement("div",{onClick:_,className:te.a.header},u.a.createElement("div",{className:te.a.name},u.a.createElement("div",null," ",t),u.a.createElement(le.a,{className:f?te.a.triangle_opened:"",size:15})),c&&u.a.createElement(oe,{text:m,changeHandler:function(e){return c(e)}}))," "),Body:function(){return u.a.createElement("div",{className:"".concat(te.a.content," ").concat(r)},n&&"function"===typeof n?n(m):n)}}))})),ue=n(27),me=n.n(ue),de=n(68),ve=n(64),fe=n.n(ve);function be(){var e=Object(l.a)(["\n    fragment StudentPreview on Student {\n        vkId\n        className\n        role,\n        banned,\n        fullName\n    }\n    {\n        students: studentMany {\n            ...StudentPreview\n        }\n    }\n"]);return be=function(){return e},e}function _e(){var e=Object(l.a)(["\n    fragment StudentPreview on Student {\n        vkId\n        className\n        banned\n        role\n        fullName\n        _id\n        __typename\n    }\n    mutation AddStudentToClass($vkId: Int!, $className: String!) {\n        student: changeClass(vkId: $vkId, newClassName: $className) {\n            ...StudentPreview\n        }\n    }\n"]);return _e=function(){return e},e}function pe(){var e=Object(l.a)(["\n    fragment StudentPreview on Student {\n        vkId\n        className\n        banned\n        role\n        fullName\n        _id\n        __typename\n    }\n    query GetStudents($className: String!){\n        students: studentsForClass(className: $className) {\n            ...StudentPreview\n        }\n    }\n"]);return pe=function(){return e},e}function he(){var e=Object(l.a)(["\n    mutation RemoveStudentFromClass($vkId: Int!) {\n        removed: removeStudentFromClass(vkId: $vkId)\n    }\n"]);return he=function(){return e},e}var ge=document.getElementById("chooseStudentModal"),Ee=Object(y.b)(he()),Oe=Object(y.b)(pe()),Ne=Object(y.b)(_e()),je=Object(y.b)(be()),Ce=function(e){var t=e.closeModal,n=e.addStudent,a=e.styles,r=e.className,c=Object(k.c)(je);return ge?me.a.createPortal(u.a.createElement("div",{className:"modal",onClick:t},u.a.createElement("div",{className:a.chooseStudent,onClick:function(e){return e.stopPropagation()}},u.a.createElement("span",{className:a.title}," \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0447\u0435\u043d\u0438\u043a\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c "),u.a.createElement(T.a,{query:c},(function(e){return u.a.createElement("div",{className:a.studentsChooser},u.a.createElement("div",{className:a.chooser},u.a.createElement("span",{className:a.chooser_name},"\u0418\u043c\u044f"),u.a.createElement("span",{className:a.chooser_vkId},"vkId"),u.a.createElement("span",{className:a.chooser_className},"\u041a\u043b\u0430\u0441\u0441")),e.students.filter((function(e){return e.className!==r})).map((function(e){return u.a.createElement("div",{key:e.vkId,className:a.chooser,onClick:function(){return n(e),t()}},u.a.createElement("span",{className:a.chooser_name},e.fullName),u.a.createElement("span",{className:a.chooser_vkId},e.vkId),u.a.createElement("span",{className:a.chooser_className},e.className))})))})))),ge):null},Se=u.a.memo((function(e){var t=e.className,n=Object(k.c)(Oe,{variables:{className:t}}),a=n.data,r=n.loading,o=n.error,l=Object(k.b)(Ee),m=Object(s.a)(l,1)[0],d=Object(k.b)(Ne),v=Object(s.a)(d,1)[0],f=Object(i.useState)(!1),b=Object(s.a)(f,2),p=b[0],h=b[1],g=Object(i.useState)(""),E=Object(s.a)(g,2),O=E[0],N=E[1],j=Object(de.a)([]),C=j.items,S=j.setFilter,y=j.setItems,w=Object(i.useContext)(Gt).role;Object(i.useEffect)((function(){(null===a||void 0===a?void 0:a.students)&&y(null===a||void 0===a?void 0:a.students)}),[null===a||void 0===a?void 0:a.students]);return u.a.createElement(ie,{name:"\u0423\u0447\u0435\u043d\u0438\u043a\u0438",defaultSearchString:O,updateSearchString:function(e){e=e.toLowerCase(),N(e),S((function(t){return-1!==t.fullName.toLowerCase().search(e)||-1!==t.role.toLocaleLowerCase().search(e)}))},className:fe.a.studentsSection},u.a.createElement(u.a.Fragment,null,u.a.createElement(T.a,{query:{data:C,loading:r,error:o}},(function(e){return u.a.createElement("div",{className:"".concat(fe.a.students)},w===_.b.contributor||w===_.b.admin&&u.a.createElement("div",{className:fe.a.creator,onClick:function(){return h(!0)}}," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0447\u0435\u043d\u0438\u043a\u0430 "),e.map((function(e){return u.a.createElement("div",{className:fe.a.student,key:e.vkId},u.a.createElement(F.b,Object.assign({searchText:O},e)),u.a.createElement(z.a,{include:_.a.reject,props:{onClick:function(){return n=e.vkId,void m({variables:{vkId:n},optimisticResponse:{removed:!0},update:function(e,a){var r,c=e.readQuery({query:Oe,variables:{className:t}});console.log(c,a),(null===c||void 0===c?void 0:c.students)&&(null===(r=a.data)||void 0===r?void 0:r.removed)&&e.writeQuery({query:Oe,variables:{className:t},data:{students:null===c||void 0===c?void 0:c.students.filter((function(e){return e.vkId!==n}))}})}});var n},size:30,className:"".concat(fe.a.remove," remove"),allowOnlyRedactor:!0}}))})))})),p&&u.a.createElement(Ce,{className:t,styles:fe.a,addStudent:function(e){v({variables:{vkId:e.vkId,className:t},optimisticResponse:{__typename:"Mutation",student:Object(c.a)({__typename:"Student"},e)},update:function(e,n){var a,r=e.readQuery({query:Oe,variables:{className:t}});(null===r||void 0===r?void 0:r.students)&&(null===(a=n.data)||void 0===a?void 0:a.student)&&e.writeQuery({query:Oe,variables:{className:t},data:{students:r.students.concat([n.data.student])}})}})},closeModal:function(){return h(!1)}})))})),ye=n(40),ke=n(34),we=n.n(ke);function Ie(){var e=Object(l.a)(["\n    mutation ChangeDay($className: String!, $dayIndex: Int!, $newDay: [String]!) {\n        changed: changeDay(className: $className, dayIndex: $dayIndex, newSchedule: $newDay) {\n            __typename\n            name\n            schedule\n        }\n    }\n"]);return Ie=function(){return e},e}function xe(){var e=Object(l.a)(["\n    query GetLessons {\n        lessons: getLessons\n    }\n"]);return xe=function(){return e},e}function He(){var e=Object(l.a)(["\n    query GetSchedule($className: String!){\n        schedule: getSchedule(className: $className)\n    }\n"]);return He=function(){return e},e}var Pe=["\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"],$e=Object(y.b)(He()),Re=Object(y.b)(xe()),Me=Object(y.b)(Ie()),De=Object(i.memo)((function(e){var t,n=e.index,a=e.lessons,r=e.lessonsList,c=e.changeDay,o=Object(i.useState)(!1),l=Object(s.a)(o,2),m=l[0],d=l[1],v=Object(i.useState)(a),f=Object(s.a)(v,2),b=f[0],p=f[1],h=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.getAttribute("data-index");if(void 0!=n){var a=Object(ye.a)(b);a[+n]=e.target.value,p(a)}};return u.a.createElement("div",{className:we.a.day,onDoubleClick:function(){return d(!0)}},u.a.createElement("div",{className:we.a.lessons},u.a.createElement("div",{className:we.a.dayName,onClick:function(){return d(!0)}}," ",Pe[n]," "),b.map((function(e,t){return m?u.a.createElement("div",{className:we.a.lessonChange,key:"picker".concat(n+e+t)},u.a.createElement("select",{"data-index":t,className:we.a.selectLesson,name:"lesson",id:we.a.pickLesson+n+e,onChange:h},u.a.createElement("option",{key:"pick-1",value:"lesson"},e),r.filter((function(t){return t!==e})).map((function(e){return u.a.createElement("option",{key:"pick".concat(we.a.pickLesson+n+e),value:e},e)}))),u.a.createElement(ne.c,{className:"remove "+we.a.removeLesson,size:20,onClick:function(){return function(e){p(b.filter((function(t,n){return n!==e})))}(t)}})):u.a.createElement("span",{key:n+e+t,className:we.a.lesson}," ",t+1,")  ",e," ")})),m&&u.a.createElement("div",{className:we.a.addLesson+" "+we.a.lesson,onClick:function(){p(b.concat([b[b.length-1]||r[0]]))}}," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0440\u043e\u043a ")),m?u.a.createElement("div",{className:we.a.changers},u.a.createElement(z.a,{include:[_.a.reject,_.a.confirm],props:(t={},Object(E.a)(t,_.a.reject,{onClick:function(){d(!1),p(a)},className:"remove ".concat(we.a.changer)}),Object(E.a)(t,_.a.confirm,{onClick:function(){d(!1),c(b,n)},className:"confirm ".concat(we.a.changer),allowOnlyRedactor:!0}),t),size:20})):u.a.createElement(z.a,{include:_.a.change,props:{className:we.a.pen,size:15,onClick:function(){return d(!0)},allowOnlyRedactor:!0}}))})),Fe=function(e){var t=e.className,n=Object(k.c)($e,{variables:{className:t}}),a=Object(k.c)(Re),r=Object(k.b)(Me),c=Object(s.a)(r,1)[0],o=function(e,a){var r;c({variables:{className:t,dayIndex:a,newDay:e},optimisticResponse:{__typename:"Mutation",changed:{__typename:"Class",name:t,schedule:(null===(r=n.data)||void 0===r?void 0:r.schedule.map((function(t,n){return n===a?e:t})))||[[],[],[],[],[],[]]}},update:function(r,c){var o,s=r.readQuery({query:$e,variables:{className:t}});(null===s||void 0===s?void 0:s.schedule)&&r.writeQuery({query:$e,variables:{className:t},data:{schedule:null===(o=n.data)||void 0===o?void 0:o.schedule.map((function(t,n){return n===a?e:t}))}})}})};return u.a.createElement(ie,{name:"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"},u.a.createElement(T.a,{queries:[n,a]},(function(e,t){return u.a.createElement("div",{className:we.a.days},e.schedule.map((function(e,n){return u.a.createElement(De,{changeDay:o,lessonsList:t.lessons,key:"day"+n,index:n,lessons:e})})))})))},qe=n(9),Te=n.n(qe),ze=n(55),Le=n.n(ze),Ae=function(e){var t=e.Stab,n=Object(O.a)(e,["Stab"]),a=Object(i.useState)(!1),r=Object(s.a)(a,2),c=r[0],o=r[1],l=document.getElementById("photoModal");return u.a.createElement(u.a.Fragment,null,u.a.createElement(t,{onClick:function(){return o(!0)}}),c&&l&&me.a.createPortal(u.a.createElement(Be,Object.assign({close:function(){return o(!1)}},n)),l))},Be=function(e){var t=e.close,n=e.nextImg,a=e.prevImg,r=Object(O.a)(e,["close","nextImg","prevImg"]),c=Object(i.useState)(r.src),o=Object(s.a)(c,2),l=o[0],m=o[1],d=Object(i.useState)(a),v=Object(s.a)(d,2),f=v[0],b=v[1],_=Object(i.useState)(n),p=Object(s.a)(_,2),h=p[0],g=p[1],E=function(e,t){var n=e.src,a=e.prevImg,r=e.nextImg;t.stopPropagation(),m(n),b(a),g(r)};return u.a.createElement("div",{className:"modal",onMouseDown:t},f&&u.a.createElement(ne.e,{"data-testid":"prevImg",size:40,className:Le.a.prev,onMouseDown:function(e){return E(f,e)}}),u.a.createElement("img",Object.assign({style:{width:"100%",maxWidth:"80vh"}},r,{src:l,onMouseDown:function(e){return e.stopPropagation()}})),h&&u.a.createElement(ne.f,{"data-testid":"nextImg",size:40,className:Le.a.next,onMouseDown:function(e){return E(h,e)}}))},Qe=function(e){var t=e.prevImg,n=e.nextImg,a=Object(O.a)(e,["prevImg","nextImg"]),r=Object(i.useState)(!1),o=Object(s.a)(r,2),l=o[0],m=o[1],d=document.getElementById("photoModal");return u.a.createElement(u.a.Fragment,null,u.a.createElement("img",Object.assign({},a,{onClick:function(){return m(!0)}})),l&&d&&me.a.createPortal(u.a.createElement(Be,Object.assign({close:function(){return m(!1)}},Object(c.a)(Object(c.a)({},a),{},{prevImg:t,nextImg:n}))),d))},Ge=function(e){var t=e.images,n=e.Stab,a=function(e){for(var t=[],n=0;n<e.length;n++){var a=Object(c.a)({},e[n]),r={};r.src=a.url,r._id=a._id||n.toString();a.url,a._id;var o=Object(O.a)(a,["url","_id"]);Object.assign(r,o),t.push(r)}if(t.length>1)for(var s=0;s<t.length;s++)s+1<t.length?t[s].nextImg=t[s+1]:t[s].nextImg=t[0],t[s].prevImg=s-1>=0?t[s-1]:t[t.length-1];return t}(t);return u.a.createElement(u.a.Fragment,null,n?u.a.createElement(Ae,Object.assign({},a[0],{Stab:n})):u.a.createElement(u.a.Fragment,null,a.map((function(e){return u.a.createElement(Qe,Object.assign({key:e._id,className:Le.a.attach,alt:"\u0424\u043e\u0442\u043e \u0434\u0437"},e))}))))},Ue=n(41),Ye=(n(118),n(50)),Je=n.n(Ye),Ve=n(81),Ze=n.n(Ve),We=function(e){return function(t){var n,a=t.reject,r=t.confirm,o=t.onChange,l=t.initState,m=void 0===l?{}:l,d=t.sectionClassName,v=t.titleClassName,f=Object.entries(e).reduce((function(e,t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return Object(c.a)(Object(c.a)({},e),{},Object(E.a)({},a,r))}),{}),b=Object(i.useState)(Object(c.a)(Object(c.a)({},f),{},{initState:m})),p=Object(s.a)(b,2),h=p[0],g=p[1];return u.a.createElement("div",{className:Ze.a.contentChanger,onMouseDown:function(e){return e.stopPropagation()}},u.a.createElement("div",{className:Ze.a.header},u.a.createElement(z.a,{include:[_.a.reject,_.a.confirm],props:(n={},Object(E.a)(n,_.a.confirm,{onClick:function(){return r(h)},className:"positive",allowOnlyRedactor:!0}),Object(E.a)(n,_.a.reject,{onClick:a,className:"negative"}),n),style:{cursor:"pointer"},size:25})),Object.entries(e).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1],r=a.title,l=a.ContentComponent,i=a.Header;return u.a.createElement("section",{className:"".concat(Ze.a.section," ").concat(d||""),key:n},i?u.a.createElement(u.a.Fragment,null,"function"===typeof i?u.a.createElement(i,{changeHandler:function(e){g(Object(c.a)(Object(c.a)({},h),{},Object(E.a)({},n,e))),null===o||void 0===o||o(Object(c.a)(Object(c.a)({},h),{},Object(E.a)({},n,e)),n)},value:h[n]}):{Header:i}):u.a.createElement(u.a.Fragment,null,r||""),u.a.createElement("h1",{className:"".concat(Ze.a.title," ").concat(v||"")}," ",r," "),u.a.createElement(l,{changeHandler:function(e){g(Object(c.a)(Object(c.a)({},h),{},Object(E.a)({},n,e))),null===o||void 0===o||o(Object(c.a)(Object(c.a)({},h),{},Object(E.a)({},n,e)),n)},value:h[n]}))})))}},Ke=n(129),Xe=n.n(Ke),et=function(e){var t=e.View,n=e.style,a=e.onChange;return u.a.createElement("label",{style:n||{}},u.a.createElement(t,null),u.a.createElement("input",{type:"file",onChange:function(e){return a(e),e.target.value=""},multiple:!0,style:{outline:0,opacity:0,pointerEvents:"none",userSelect:"none",display:"none"}}))},tt=function(e){var t=e.attachment,n=e.remove;return u.a.createElement("div",{className:Le.a.deletableAttachment},u.a.createElement(Qe,{src:t,alt:"\u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435"}),u.a.createElement(ne.c,{size:20,onClick:n,className:Le.a.removeAttachment+" negative"}))},nt=function(e){return"photo".concat(e.owner_id,"_").concat(e.id)},at=function(e){return e.sizes.reduce((function(e,t){return t.height>e.height?t:e}),{height:0,url:""}).url},rt={to:{title:"\u0414\u0430\u0442\u0430",ContentComponent:function(e){var t=e.changeHandler,n=e.value;return u.a.createElement(Xe.a,{selected:new Date(n),onChange:function(e){null!==e&&t(e.toISOString())},minDate:new Date,dateFormat:"dd/MM/yyyy",className:Je.a.datePickerInput,showPopperArrow:!1,calendarClassName:Je.a.datePickerCalendar})},defaultValue:(new Date).toISOString()},attachments:{Header:function(e){var t=e.changeHandler,n=e.value,a=function(){var e=Object(o.a)(r.a.mark((function e(a){var c,o,s,l,i,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(c=a.target.files)){e.next=11;break}for(o=new FormData,s=0;s<c.length;s++)o.append("newAttachment",c[s]);return e.next=7,fetch("localhost"===document.location.hostname?"http://localhost:8080/saveAttachment":document.location.origin.endsWith("/")?document.location.origin+"saveAttachment":document.location.origin+"/saveAttachment",{method:"POST",body:o,headers:{accepts:"application/json"}}).then((function(e){return e.json()}));case 7:l=e.sent,i=l.photos,u=i.map((function(e,t){return{url:at(e),value:nt(e),_id:t+Date.now().toString(),__typename:"ClassHomeworkAttachment"}})),t([].concat(Object(ye.a)(n),Object(ye.a)(u)));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}();return u.a.createElement("div",{className:Je.a.header},u.a.createElement("h1",{className:Je.a.title}," \u0412\u043b\u043e\u0436\u0435\u043d\u0438\u044f "),u.a.createElement(et,{View:function(){return u.a.createElement(ne.d,{size:25,className:Je.a.uploaderIcon})},onChange:a}))},ContentComponent:function(e){var t=e.value,n=e.changeHandler;return u.a.createElement("div",{className:Je.a.attachmentsContainer},t.map((function(e){return u.a.createElement(tt,{key:e._id,attachment:e.url,remove:function(){n(t.filter((function(t){return t._id!==e._id})))}})})))},defaultValue:[]},text:{title:"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f \u0440\u0430\u0431\u043e\u0442\u0430",ContentComponent:function(e){var t=e.value,n=e.changeHandler;return u.a.createElement("textarea",{autoFocus:!0,name:"text",value:t,className:Je.a.text,onChange:function(e){n(e.target.value)},cols:60,rows:5},t)},defaultValue:""}},ct=We(rt),ot=We(Object(c.a)({lesson:{title:"\u0423\u0440\u043e\u043a",ContentComponent:function(e){var t=e.value,n=e.changeHandler,a=Object(g.g)().className,r=Object(k.c)($e,{variables:{className:a}}),c=Object(k.c)(Re);return u.a.createElement(T.a,{queries:[r,c]},(function(e,a){var r=e.schedule,c=a.lessons.filter((function(e){return r.some((function(t){return t.includes(e)}))}));return u.a.createElement("select",{className:Je.a.selectLesson,onChange:function(e){return n(e.target.value)},value:t},!t&&u.a.createElement("option",{key:"possibleLessonNothing",value:""},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442"),c.map((function(e,t){return u.a.createElement("option",{key:"possibleLesson".concat(e),value:e},e)})))}))}}},rt));function st(){var e=Object(l.a)(["\n    mutation RemoveOldHomework($className: String!) {\n        removeOldHomework(className: $className) {\n            to\n            text\n            attachments {\n                url\n                value\n                _id\n            }\n            lesson\n            _id\n            createdBy\n        }\n    }\n"]);return st=function(){return e},e}function lt(){var e=Object(l.a)(["\n    mutation addHomework($className: String!, $text: String!, $to: String, $lesson: String!, $attachments: [ClassHomeworkAttachmentsInput]!) {\n        addHomework(className: $className, text: $text, to: $to, lesson: $lesson, attachments: $attachments) {\n            __typename\n            text\n            _id\n            lesson\n            to\n            attachments {\n                url\n                value\n            }\n        }\n    }\n"]);return lt=function(){return e},e}function it(){var e=Object(l.a)(["\n    mutation ChangeHomework($className: String!, $homeworkId: String!, $updates: ClassHomeworkInput!) {\n        updateHomework(className: $className, homeworkId: $homeworkId, updates: $updates) {\n            _id \n            text\n            attachments { \n                url \n                value\n                _id\n            }\n            to\n            lesson\n        }\n    }\n"]);return it=function(){return e},e}function ut(){var e=Object(l.a)(["\n    mutation RemoveTask($className: String!, $homeworkId: String!) {\n        removeHomework(homeworkId: $homeworkId, className: $className)\n    }\n"]);return ut=function(){return e},e}function mt(){var e=Object(l.a)(["\n    query GetHomework($className: String!) {\n        homework: getHomework(className: $className) {\n            text\n            createdBy\n            to\n            attachments {\n                url\n                value\n                _id\n            }\n            lesson\n            _id\n            __typename\n        }\n    }\n"]);return mt=function(){return e},e}var dt=document.getElementById("changeContentModal"),vt=Object(y.b)(mt()),ft=Object(y.b)(ut()),bt=Object(y.b)(it()),_t=Object(y.b)(lt()),pt=Object(y.b)(st()),ht=function(e){var t,n=e.homework,a=e.removeHomework,r=e.updateHomework,c=Object(i.useState)(!1),o=Object(s.a)(c,2),l=o[0],m=o[1];return u.a.createElement("div",{className:"".concat(Te.a.container," ").concat(2===n.attachments.length?Te.a.pair:""),onDoubleClick:function(){return m(!0)}},u.a.createElement("div",{key:n._id,className:Te.a.element},n.attachments.length>0&&u.a.createElement(u.a.Fragment,null," ",n.attachments.length<=2?u.a.createElement("div",{className:Te.a.attachments},u.a.createElement(Ge,{images:n.attachments})):u.a.createElement(Ge,{images:n.attachments,Stab:function(e){var t=e.onClick;return u.a.createElement("div",{className:Te.a.stab,onClick:t},u.a.createElement("span",null,n.attachments.length),u.a.createElement("span",null," Photos "))}})," "),n.text&&u.a.createElement("p",{className:Te.a.text}," ",n.text," "),l&&dt&&me.a.createPortal(u.a.createElement("div",{className:"modal",onMouseDown:function(){return m(!1)}},u.a.createElement(ot,{initState:n,confirm:function(e){return r(n._id,e),m(!1)},reject:function(){return m(!1)}})),dt)),u.a.createElement("div",{className:Te.a.controls},u.a.createElement(z.a,{include:[_.a.change,_.a.delete],props:(t={},Object(E.a)(t,_.a.change,{onClick:function(){return m(!0)},className:"".concat(Te.a.pen),size:15}),Object(E.a)(t,_.a.delete,{onClick:function(){return a(n._id)},className:"".concat(Te.a.remove),size:20}),t),withRoleControl:!0})))},gt=function(e){var t=e.returnHomework,n=e.close,a=e.initContent,r=void 0===a?{}:a;return dt?me.a.createPortal(u.a.createElement("div",{className:"modal",onMouseDown:n},u.a.createElement(ot,{initState:r,confirm:function(e){return t(e),n()},reject:n})),dt):null},Et=function(e){var t=e.onClick;return u.a.createElement(z.a,{include:_.a.add,props:Object(E.a)({},_.a.add,{className:Te.a.addContent,size:30,onClick:t,allowOnlyRedactor:!0})})},Ot=function(e){var t,n={},a=Object(N.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,c=r.lesson;n.hasOwnProperty(c)?n[c].push(r):n[c]=[r]}}catch(o){a.e(o)}finally{a.f()}return n},Nt=function(e){var t,n=e.className,a=Object(i.useState)(!1),r=Object(s.a)(a,2),o=r[0],l=r[1],m=Object(i.useState)({}),d=Object(s.a)(m,2),v=d[0],f=d[1],b=Object(k.c)(vt,{variables:{className:n}}),p=Object(k.b)(ft),h=Object(s.a)(p,1)[0],g=Object(k.b)(bt),E=Object(s.a)(g,1)[0],N=Object(k.b)(_t),j=Object(s.a)(N,1)[0],C=Object(k.b)(pt,{variables:{className:n},optimisticResponse:{removeOldHomework:(null===(t=b.data)||void 0===t?void 0:t.homework.filter((function(e){var t=e.to;return Date.now()-Date.parse(t)<=864e5})))||[]},update:function(e,t){var a;t&&(null===(a=t.data)||void 0===a?void 0:a.removeOldHomework)&&e.writeQuery({query:vt,variables:{className:n},data:{homework:t.data.removeOldHomework}})}}),S=Object(s.a)(C,1)[0],y=function(e){e&&h({variables:{className:n,homeworkId:e},optimisticResponse:{__typename:"Mutation",removeHomework:e},update:function(t,a){var r=t.readQuery({query:vt,variables:{className:n}});(null===a||void 0===a?void 0:a.data)&&t.writeQuery({query:vt,variables:{className:n},data:{homework:(null===r||void 0===r?void 0:r.homework.filter((function(t){return t._id!==e})))||[]}})}})},w=function(e,t){t.__typename;var a,r,o=Object(O.a)(t,["__typename"]);e&&E({variables:{className:n,homeworkId:e,updates:Object(c.a)(Object(c.a)({},o),{},{attachments:null===(a=t.attachments)||void 0===a?void 0:a.map((function(e){e.__typename;return Object(O.a)(e,["__typename"])}))})},optimisticResponse:{__typename:"Mutation",updateHomework:Object(c.a)(Object(c.a)({__typename:"ClassHomework",_id:e},null===b||void 0===b||null===(r=b.data)||void 0===r?void 0:r.homework.find((function(t){return t._id===e}))),t)},update:function(t,a){var r=t.readQuery({query:vt,variables:{className:n}});(null===a||void 0===a?void 0:a.data)&&t.writeQuery({query:vt,variables:{className:n},data:{homework:(null===r||void 0===r?void 0:r.homework.map((function(t){var n;return t._id===e?null===(n=a.data)||void 0===n?void 0:n.updateHomework:t})))||[]}})}})};return u.a.createElement(u.a.Fragment,null,u.a.createElement(ie,{name:"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f \u0440\u0430\u0431\u043e\u0442\u0430",Header:function(e){var t=e.opened,n=e.onClick;return u.a.createElement("div",{className:"".concat(Te.a.sectionHeader," ").concat(Te.a.contentHeader),onClick:n},u.a.createElement("div",{className:Te.a.title},"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f \u0440\u0430\u0431\u043e\u0442\u0430",u.a.createElement(le.a,{className:t?Te.a.triangle_opened:"",size:15})),u.a.createElement(Et,{onClick:function(e){return e.stopPropagation(),l(!0)}}))}},u.a.createElement(T.a,{query:b},(function(e){var t=Object(Ue.d)(e.homework),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(Ue.c)(r,Ot),o=Object(Ue.c)(a,Ot);return u.a.createElement("div",{className:Te.a.content},Object.keys(o).length>0&&u.a.createElement(se,{initiallyOpened:!1,Head:function(e){var t=e.opened,n=e.onClick;return u.a.createElement("div",{className:Te.a.oldContentHeader},u.a.createElement("p",{className:"".concat(Te.a.date," ").concat(Te.a.accordion),onClick:n},"\u0421\u0442\u0430\u0440\u043e\u0435 \u0434\u0437",u.a.createElement(le.a,{size:15,className:t?Te.a.triangle_opened:""})),u.a.createElement(z.a,{include:_.a.delete,props:{allowOnlyRedactor:!0,className:"remove ".concat(Te.a.removeOldContent),size:20,onClick:function(){return S()}}}))},Body:function(){return u.a.createElement(u.a.Fragment,null,Object.keys(o).map((function(e){return u.a.createElement(se,{initiallyOpened:!1,className:Te.a.offseted,key:e,Head:function(t){var n=t.onClick,a=t.opened;return u.a.createElement("p",{className:"".concat(Te.a.date," ").concat(Te.a.accordion),onClick:n},e,u.a.createElement(le.a,{size:15,className:a?Te.a.triangle_opened:""}))},Body:function(){return u.a.createElement(u.a.Fragment,null,Object.keys(o[e]).map((function(t){return u.a.createElement(se,{className:Te.a.offseted,key:e+t,Head:function(e){var n=e.onClick,a=e.opened;return u.a.createElement("p",{className:"".concat(Te.a.lesson," ").concat(Te.a.accordion),onClick:n},t,u.a.createElement(le.a,{className:a?Te.a.triangle_opened:"",size:10}))},Body:function(){return u.a.createElement("div",{className:"".concat(Te.a.elements," ").concat(Te.a.offseted)},o[e][t].map((function(e,t){return u.a.createElement(ht,{updateHomework:w,key:e._id,removeHomework:y,homework:e})})))}})})))}})})))}}),Object.keys(c).map((function(e){return u.a.createElement(se,{key:e,Head:function(t){var n=t.onClick,a=t.opened;return u.a.createElement("div",{className:Te.a.sectionHeader,onClick:n},u.a.createElement("div",{className:"".concat(Te.a.date," ").concat(Te.a.accordion)},e,u.a.createElement(le.a,{className:a?Te.a.triangle_opened:"",size:15})),u.a.createElement(Et,{onClick:function(t){return t.stopPropagation(),l(!0),f({to:Object(Ue.a)(e)})}}))},Body:function(){return u.a.createElement(u.a.Fragment,null,Object.keys(c[e]).map((function(t){return u.a.createElement(se,{className:Te.a.offseted,key:e+t,Head:function(n){var a=n.onClick,r=n.opened;return u.a.createElement("div",{className:Te.a.sectionHeader,onClick:a},u.a.createElement("div",{className:"".concat(Te.a.lesson," ").concat(Te.a.accordion)},t,u.a.createElement(le.a,{className:r?Te.a.triangle_opened:"",size:15})),u.a.createElement(Et,{onClick:function(n){return n.stopPropagation(),l(!0),f({to:Object(Ue.a)(e),lesson:t})}}))},Body:function(){return u.a.createElement("div",{className:"".concat(Te.a.elements," ").concat(Te.a.offseted)},c[e][t].map((function(e,t){return u.a.createElement(ht,{updateHomework:w,key:e._id,removeHomework:y,homework:e})})))}})})))}})})))}))),dt&&o&&me.a.createPortal(u.a.createElement(gt,{returnHomework:function(e){j({variables:Object(c.a)(Object(c.a)({},e),{},{className:n,attachments:e.attachments.map((function(e){e.__typename;return Object(O.a)(e,["__typename"])}))}),optimisticResponse:{__typename:"Mutation",addHomework:Object(c.a)(Object(c.a)({},e),{},{_id:Date.now().toString(),__typename:"ClassHomework"})},refetchQueries:[{query:vt,variables:{className:n}}]}),f({})},close:function(){return l(!1),f({})},initContent:v}),dt))};function jt(){var e=Object(l.a)(["\n    mutation addChange($className: String!, $text: String!, $to: String, $attachments: [ClassHomeworkAttachmentsInput]!) {\n        addChange(className: $className, text: $text, to: $to, attachments: $attachments) {\n            __typename\n            text\n            _id\n            to\n            attachments {\n                url\n                value\n            }\n        }\n    }\n"]);return jt=function(){return e},e}function Ct(){var e=Object(l.a)(["\n    mutation UpdateChange($className: String!, $changeId: String!, $updates: ClassChangesInput!) {\n        updateChange(className: $className, changeId: $changeId, updates: $updates) {\n            _id \n            text\n            attachments { \n                url \n                value\n                _id\n            }\n            to\n        }\n    }\n"]);return Ct=function(){return e},e}function St(){var e=Object(l.a)(["\n    mutation RemoveChange($className: String!, $changeId: String!) {\n        removeChange(changeId: $changeId, className: $className)\n    }\n"]);return St=function(){return e},e}function yt(){var e=Object(l.a)(["\n    query GetChanges($className: String!) {\n        changes: getChanges(className: $className) {\n            text\n            createdBy\n            to\n            attachments {\n                url\n                value\n                _id\n            }\n            _id\n            __typename\n        }\n    }\n"]);return yt=function(){return e},e}var kt=document.getElementById("changeContentModal"),wt=Object(y.b)(yt()),It=Object(y.b)(St()),xt=Object(y.b)(Ct()),Ht=Object(y.b)(jt()),Pt=function(e){var t,n=e.change,a=e.removeChange,r=e.updateChange,c=Object(i.useState)(!1),o=Object(s.a)(c,2),l=o[0],m=o[1];return u.a.createElement("div",{className:"".concat(Te.a.container," ").concat(2===n.attachments.length?Te.a.pair:""),onDoubleClick:function(){return m(!0)}},u.a.createElement("div",{key:n._id,className:Te.a.element},n.attachments.length>0&&u.a.createElement(u.a.Fragment,null," ",n.attachments.length<=2?u.a.createElement("div",{className:Te.a.attachments},u.a.createElement(Ge,{images:n.attachments})):u.a.createElement(Ge,{images:n.attachments,Stab:function(e){var t=e.onClick;return u.a.createElement("div",{className:Te.a.stab,onClick:t},u.a.createElement("span",null,n.attachments.length),u.a.createElement("span",null," Photos "))}})," "),n.text&&u.a.createElement("p",{className:Te.a.text}," ",n.text," "),l&&kt&&me.a.createPortal(u.a.createElement("div",{className:"modal",onMouseDown:function(){return m(!1)}},u.a.createElement(ct,{initState:n,confirm:function(e){return r(n._id,e),m(!1)},reject:function(){return m(!1)}})),kt)),u.a.createElement("div",{className:Te.a.controls},u.a.createElement(z.a,{include:[_.a.change,_.a.delete],props:(t={},Object(E.a)(t,_.a.change,{onClick:function(){return m(!0)},className:"".concat(Te.a.pen),size:15}),Object(E.a)(t,_.a.delete,{onClick:function(){return a(n._id)},className:"".concat(Te.a.remove),size:20}),t),withRoleControl:!0})))},$t=function(e){var t=e.returnChange,n=e.close,a=e.initContent,r=void 0===a?{}:a;return kt?me.a.createPortal(u.a.createElement("div",{className:"modal",onMouseDown:n},u.a.createElement(ct,{initState:r,confirm:function(e){return t(e),n},reject:n})),kt):null},Rt=function(e){var t=e.onClick;return u.a.createElement(z.a,{include:_.a.add,props:Object(E.a)({},_.a.add,{className:Te.a.addContent,size:30,onClick:t,allowOnlyRedactor:!0})})},Mt=function(e){var t=e.className,n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],o=a[1],l=Object(i.useState)({}),m=Object(s.a)(l,2),d=m[0],v=m[1],f=Object(k.c)(wt,{variables:{className:t}}),b=Object(k.b)(It),_=Object(s.a)(b,1)[0],p=Object(k.b)(xt),h=Object(s.a)(p,1)[0],g=Object(k.b)(Ht),E=Object(s.a)(g,1)[0],N=function(e){e&&_({variables:{className:t,changeId:e},optimisticResponse:{__typename:"Mutation",removeChange:e},update:function(n,a){var r=n.readQuery({query:wt,variables:{className:t}});(null===a||void 0===a?void 0:a.data)&&n.writeQuery({query:wt,variables:{className:t},data:{changes:(null===r||void 0===r?void 0:r.changes.filter((function(t){return t._id!==e})))||[]}})}})},j=function(e,n){n.__typename;var a,r,o=Object(O.a)(n,["__typename"]);e&&h({variables:{className:t,changeId:e,updates:Object(c.a)(Object(c.a)({},o),{},{attachments:null===(a=n.attachments)||void 0===a?void 0:a.map((function(e){e.__typename;return Object(O.a)(e,["__typename"])}))})},optimisticResponse:{__typename:"Mutation",updateChange:Object(c.a)(Object(c.a)({__typename:"ClassChange",_id:e},null===f||void 0===f||null===(r=f.data)||void 0===r?void 0:r.changes.find((function(t){return t._id===e}))),n)},update:function(n,a){var r=n.readQuery({query:wt,variables:{className:t}});(null===a||void 0===a?void 0:a.data)&&n.writeQuery({query:wt,variables:{className:t},data:{homework:(null===r||void 0===r?void 0:r.changes.map((function(t){var n;return t._id===e?null===(n=a.data)||void 0===n?void 0:n.updateChange:t})))||[]}})}})};return u.a.createElement(u.a.Fragment,null,u.a.createElement(ie,{name:"\u0414\u043e\u043c\u0430\u0448\u043d\u044f\u044f \u0440\u0430\u0431\u043e\u0442\u0430",Header:function(e){var t=e.opened,n=e.onClick;return u.a.createElement("div",{className:"".concat(Te.a.sectionHeader," ").concat(Te.a.contentHeader),onClick:n},u.a.createElement("div",{className:Te.a.title},"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0438",u.a.createElement(le.a,{className:t?Te.a.triangle_opened:"",size:15})),u.a.createElement(Rt,{onClick:function(e){return e.stopPropagation(),o(!0)}}))}},u.a.createElement(T.a,{query:f},(function(e){var t=Object(Ue.d)(e.changes),n=Object(s.a)(t,2),a=(n[0],n[1]);return u.a.createElement("div",{className:Te.a.content},Object.keys(a).map((function(e){return u.a.createElement(se,{key:e,Head:function(t){var n=t.onClick,a=t.opened;return u.a.createElement("div",{className:Te.a.sectionHeader,onClick:n},u.a.createElement("div",{className:Te.a.title},e,u.a.createElement(le.a,{className:a?Te.a.triangle_opened:"",size:15})),u.a.createElement(Rt,{onClick:function(t){return t.stopPropagation(),o(!0),v({to:Object(Ue.a)(e)})}}))},Body:function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"".concat(Te.a.elements," ").concat(Te.a.offseted)},a[e].map((function(e,t){return u.a.createElement(Pt,{updateChange:j,key:e._id,removeChange:N,change:e})}))))}})})))}))),kt&&r&&me.a.createPortal(u.a.createElement($t,{returnChange:function(e){var n;console.log(e),E({variables:Object(c.a)(Object(c.a)({},e),{},{className:t,attachments:null===e||void 0===e||null===(n=e.attachments)||void 0===n?void 0:n.map((function(e){e.__typename;return Object(O.a)(e,["__typename"])}))}),optimisticResponse:{__typename:"Mutation",addChange:Object(c.a)(Object(c.a)({},e),{},{_id:Date.now().toString(),__typename:"ClassChange"})},refetchQueries:[{query:wt,variables:{className:t}}]})},close:function(){return o(!1)},initContent:d}),kt))},Dt=n(56);function Ft(){var e=Object(l.a)(["\n    mutation RemoveClass($className: String!) {\n        classRemoveOne(className: $className) {\n            name\n        }\n    } \n"]);return Ft=function(){return e},e}var qt=Object(y.b)(Ft()),Tt=function(e){Object(j.a)(e);var t=Object(k.b)(qt),n=Object(s.a)(t,1)[0],a=Object(g.g)().className,r=Object(i.useState)(!1),c=Object(s.a)(r,2),o=c[0],l=c[1];return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:X.a.class},u.a.createElement("div",{className:X.a.header},u.a.createElement("div",{className:X.a.className}," ",a," "),u.a.createElement(z.a,{include:_.a.delete,props:{onClick:function(){return l(!0)},size:30,className:"remove",style:{cursor:"pointer"},allowOnlyAdmin:!0}})),u.a.createElement("div",{className:X.a.content},u.a.createElement(Se,{className:a}),u.a.createElement(Fe,{className:a}),u.a.createElement(Nt,{className:a}),u.a.createElement(Mt,{className:a}))),o&&u.a.createElement(L.a,{text:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ".concat(a," \u043a\u043b\u0430\u0441\u0441"),onConfirm:function(){n({variables:{className:a},optimisticResponse:{classRemoveOne:{name:a,__typename:"Class"},__typename:"Mutation"},update:function(e,t){var n=e.readQuery({query:Dt.GET_CLASSES});if((null===n||void 0===n?void 0:n.classes)&&t.data)return e.writeQuery({query:Dt.GET_CLASSES,data:{classes:null===n||void 0===n?void 0:n.classes.filter((function(e){var n;return e.name!==(null===(n=t.data)||void 0===n?void 0:n.classRemoveOne.name)}))}}),u.a.createElement(g.a,{to:"/classes"})}})},returnRes:function(){return l(!1)}}))},zt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return u.a.createElement(Gt.Consumer,null,(function(n){var a=n.isAuth,r=n.role,c=n.className;return u.a.createElement(u.a.Fragment,null," ",a?u.a.createElement(u.a.Fragment,null,r===_.b.admin||t?u.a.createElement(e,null):u.a.createElement(g.a,{to:"/classes/".concat(c)})):u.a.createElement(g.a,{to:"/auth"}))}))};function Lt(){var e=Object(l.a)(["\n    query GET_STUDENT($filter: FilterFindOneStudentInput!) {\n        student: studentOne(filter: $filter) {\n            role\n            className\n        } \n    }\n"]);return Lt=function(){return e},e}var At=Object(i.lazy)((function(){return Promise.resolve().then(n.bind(null,56))})),Bt=Object(i.lazy)((function(){return Promise.resolve().then(n.bind(null,110))})),Qt=Object(i.lazy)((function(){return n.e(3).then(n.bind(null,210))})),Gt=u.a.createContext({isAuth:!1,role:_.b.student,className:"\u041d\u0435\u0442\u0443",photo:"",photo_rec:"",last_name:"",first_name:"",uid:NaN}),Ut=Object(y.b)(Lt());t.b=function(){var e=Object(k.a)(),t=Object(i.useState)(null),n=Object(s.a)(t,2),a=n[0],l=n[1],m=function(){var t=Object(o.a)(r.a.mark((function t(n){var a,o,s,i,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.query({query:Ut,variables:{filter:{vkId:n.uid}}});case 2:a=t.sent,o=a.data.student,s=o.role,i=o.className,u=Object(c.a)(Object(c.a)({},n),{},{role:s,className:i}),l(u),localStorage.setItem("user",JSON.stringify(u));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(i.useEffect)((function(){if(!a){var e=localStorage.getItem("user");if(e){var t=JSON.parse(e);"object"===typeof t?l(t):localStorage.removeItem("user")}}}),[]),u.a.createElement(Gt.Provider,{value:Object(c.a)({isAuth:null!==a},a)},u.a.createElement("div",{className:"wrapper"},u.a.createElement("div",{className:"app"},null===a?u.a.createElement(i.Suspense,{fallback:u.a.createElement("div",null,"loading...")},u.a.createElement(Qt,{setUser:m})):u.a.createElement(u.a.Fragment,null,u.a.createElement(h,{setUser:l}),u.a.createElement("div",{className:"content"},u.a.createElement(i.Suspense,{fallback:u.a.createElement("div",null," Loading... ")},u.a.createElement(g.d,null,u.a.createElement(g.b,{exact:!0,path:"/classes",component:function(){return zt(At)}}),u.a.createElement(g.b,{path:"/classes/:className",render:function(e){return e.match.params.className===a.className?u.a.createElement(Tt,null):zt(Tt)}}),u.a.createElement(g.b,{exact:!0,path:"/students",component:function(){return zt(Bt)}}),u.a.createElement(g.b,{path:"/students/:vkId",component:function(){return zt(W,!0)}}),u.a.createElement(g.b,{path:"*",render:function(){return u.a.createElement(g.a,{to:"/classes"})}}))))))))}}},[[133,1,2]]]);
//# sourceMappingURL=main.ca7613f1.chunk.js.map